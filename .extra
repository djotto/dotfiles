#!/usr/bin/env bash

# This file runs last, and contains overrides

# This block overrides code in .aliases
# Replace MacOS's ls with GNU's ls. GNU's ls is available in brew's coreutils.

# Check if gls exists and set the appropriate color flags and environmental variables
if type gls &>/dev/null; then
	colorflag="--color"

	LS_COLORS="rs=$(get_color_ls):"                          # reset
	LS_COLORS+="no=$(get_color_ls):"                         # normal text
	LS_COLORS+="fi=$(get_color_ls):"                         # regular files
	LS_COLORS+="di=$(get_color_ls 'red' '' 'bold'):"         # directories
	LS_COLORS+="ln=$(get_color_ls 'cyan' '' 'bold'):"        # symbolic links
	LS_COLORS+="pi=$(get_color_ls 'yellow' 'black'):"        # pipes
	LS_COLORS+="so=$(get_color_ls 'magenta' '' 'bold'):"     # sockets
	LS_COLORS+="do=$(get_color_ls 'magenta' '' 'bold'):"     # doors
	LS_COLORS+="bd=$(get_color_ls 'yellow' 'black' 'bold'):" # block devices
	LS_COLORS+="cd=$(get_color_ls 'yellow' 'black' 'bold'):" # character devices
	LS_COLORS+="or=$(get_color_ls 'red' 'black' 'bold'):"    # orphan symbolic links
	LS_COLORS+="ex=$(get_color_ls 'green' '' 'bold'):"       # executables
	# archive files
	LS_COLORS+="*.tar=$(get_color_ls 'red' '' 'bold'):*.tgz=$(get_color_ls 'red' '' 'bold'):*.arj=$(get_color_ls 'red' '' 'bold'):*.taz=$(get_color_ls 'red' '' 'bold'):*.lzh=$(get_color_ls 'red' '' 'bold'):*.zip=$(get_color_ls 'red' '' 'bold'):*.z=$(get_color_ls 'red' '' 'bold'):*.Z=$(get_color_ls 'red' '' 'bold'):*.gz=$(get_color_ls 'red' '' 'bold'):*.bz2=$(get_color_ls 'red' '' 'bold'):*.deb=$(get_color_ls 'red' '' 'bold'):*.rpm=$(get_color_ls 'red' '' 'bold'):*.jar=$(get_color_ls 'red' '' 'bold'):"
	# multimedia files
	LS_COLORS+="*.jpg=$(get_color_ls 'magenta' '' 'bold'):*.jpeg=$(get_color_ls 'magenta' '' 'bold'):*.gif=$(get_color_ls 'magenta' '' 'bold'):*.bmp=$(get_color_ls 'magenta' '' 'bold'):*.pbm=$(get_color_ls 'magenta' '' 'bold'):*.pgm=$(get_color_ls 'magenta' '' 'bold'):*.ppm=$(get_color_ls 'magenta' '' 'bold'):*.tga=$(get_color_ls 'magenta' '' 'bold'):*.xbm=$(get_color_ls 'magenta' '' 'bold'):*.xpm=$(get_color_ls 'magenta' '' 'bold'):*.tif=$(get_color_ls 'magenta' '' 'bold'):*.tiff=$(get_color_ls 'magenta' '' 'bold'):*.png=$(get_color_ls 'magenta' '' 'bold'):*.mov=$(get_color_ls 'magenta' '' 'bold'):*.mpg=$(get_color_ls 'magenta' '' 'bold'):*.mpeg=$(get_color_ls 'magenta' '' 'bold'):*.avi=$(get_color_ls 'magenta' '' 'bold'):*.fli=$(get_color_ls 'magenta' '' 'bold'):*.gl=$(get_color_ls 'magenta' '' 'bold'):*.dl=$(get_color_ls 'magenta' '' 'bold'):*.xcf=$(get_color_ls 'magenta' '' 'bold'):*.xwd=$(get_color_ls 'magenta' '' 'bold'):*.ogg=$(get_color_ls 'magenta' '' 'bold'):*.mp3=$(get_color_ls 'magenta' '' 'bold'):*.wav=$(get_color_ls 'magenta' '' 'bold'):"
	export LS_COLORS
	ls_cmd="gls"
else
	# this is untested.
	colorflag="-G"
	export LSCOLORS='BxBxhxDxfxhxhxhxhxcxcx'
	ls_cmd="ls"
fi

# Define aliases using the determined command and color flag
alias l="command ${ls_cmd} -lF ${colorflag}"
alias la="command ${ls_cmd} -lAF ${colorflag}"
alias lsd="command ${ls_cmd} -lF ${colorflag} | grep --color=never '^d'"
alias ls="command ${ls_cmd} ${colorflag}"
